
<div class="h-100 d-flex flex-column overflow-auto" style="max-height: inherit; padding: 0!important;">


    <form [formGroup]="form">
        <div class="row">
            <div class="col-md-5">
                <mat-card>

                    <div class="row">
                        <div class="col-md-4">
                            <mat-form-field tabindex="0">
                                <mat-label>Ø´Ù…Ø§Ø±Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø®Ø±ÙˆØ¬</mat-label>
                                <input formControlName="requestNumber" matInput type="text" required>
                            </mat-form-field>
                        </div>
                        <div class="col-md-5">
                            <app-combo-warhouse-tree [DefaultId]="form.controls.warehouseId.value"
                                                     (SelectId)="WarehouseIdSelect($event)"
                                                     [lablelTitleCombo]="'Ø§Ù†Ø¨Ø§Ø±'"
                                                     [isRequired]="true"
                                                     [isLastLevel]="true" [tabindex]="1">
                            </app-combo-warhouse-tree>
                        </div>
                        <div class="col-md-3">
                            <button mat-raised-button color="primary" type="submit" (click)="getData()" [disabled]="_notificationService.isLoader" tabindex="2" id="Search">


                                <span>  Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¯Ø± erp</span>
                            </button>

                        </div>

                    </div>

                </mat-card>

            </div>
             <div class="col-md-7">
                 <label *ngIf="requests!=undefined && iSsubmitForm==0 && !isShowSubmit">
                     ÙˆØ¶Ø¹ÛŒØª Ø®Ø±ÙˆØ¬ Ù¾Ø§ÛŒØ§Ù† ÙØ±Ø¢ÛŒÙ†Ø¯ ØªØ­ÙˆÛŒÙ„ Ù†ÛŒØ³Øª
                 </label>
                 <mat-card *ngIf="requests!=undefined && iSsubmitForm==0 && isShowSubmit">

                   <div class="row">
                     <div class="col-md-4">

                       <app-combo-account-head-tree [DefaultId]="form.controls.debitAccountHeadId.value"
                                                    (SelectId)="debitAccountHeadIdSelect($event)"
                                                    [isRequired]="true"
                                                    [lablelTitleCombo]="'Ø³Ø±ÙØµÙ„ Ø­Ø³Ø§Ø¨ Ø¨Ø¯Ù‡Ú©Ø§Ø±'"
                                                    [isLastLevel]="true" [tabindex]="3">
                       </app-combo-account-head-tree>

                     </div>
                     
                     <div class="col-md-4">

                       <app-combo-account-refrence [DefaultId]="form.controls.debitAccountReferenceId.value"
                                                   [accountHeadId]="form.controls.debitAccountHeadId.value"
                                                   (SelectId)="debitReferenceSelect($event)"
                                                   [lablelTitleCombo]="'Ø­Ø³Ø§Ø¨ Ø¨Ø¯Ù‡Ú©Ø§Ø± (ØªØ­ÙˆÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡)'"
                                                   [isRequired]="true"
                                                   [accountReferencesGroupsId]="form.controls.debitAccountReferenceGroupId.value" [tabindex]="4">
                       </app-combo-account-refrence>


                     </div>
                     <div class="col-md-2" *ngIf="Service.identityService.doesHavePermission('allowConfirmDocumentIssuance')">

                       <mat-form-field [tabindex]="5">
                         <mat-label>ÙˆØ¶Ø¹ÛŒØª Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ</mat-label>
                         <mat-select formControlName="isDocumentIssuance">

                           <mat-option [value]="false">
                             Ø«Ø¨Øª Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ù†Ø´ÙˆØ¯
                           </mat-option>
                           <mat-option [value]="true">
                             Ø«Ø¨Øª Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø´ÙˆØ¯
                           </mat-option>
                         </mat-select>
                       </mat-form-field>
                     </div>
                     <div class="col-md-2">
                       <button mat-raised-button color="primary" type="submit" (click)="onSave()" [disabled]="_notificationService.isLoader" id="Save" style="margin-right:7px;" tabindex="5">
                         <span>ØªØ§ÛŒÛŒØ¯ Ùˆ Ø°Ø®ÛŒØ±Ù‡</span>
                       </button>
                     </div>
                   </div>


                 </mat-card>

             </div>
           
        
        </div>

</form>
  

    <mat-card *ngIf="requests!=undefined">
        <div class="row line">
            <div class="col-md-4">
                <mat-label>Ø´Ù…Ø§Ø±Ù‡ Ø­ÙˆØ§Ù„Ù‡</mat-label>
                :
                <label class="btn-link" (click)="navigateToreceiptDetails(requests.request)" *ngIf="requests?.request?.newSearch==false">{{form.controls.documentNo.value}}</label>
            </div>
            <div class="col-md-4">
                <mat-label>Ø´Ù…Ø§Ø±Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª</mat-label>
                :
                <label>{{requests?.request?.requestNo}}</label>
            </div>
            <div class="col-md-4">
                <mat-label>Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯Ù‡Ù†Ø¯Ù‡</mat-label>
                :
                <label>{{requests?.request?.requesterTitle}}</label>
            </div>
            <div class="col-md-4">
                <mat-label>ØªØ§Ø±ÛŒØ® Ø¯Ø±Ø®ÙˆØ§Ø³Øª</mat-label>
                :
                <label>{{requests?.request?.requestDate_Jalali}}</label>
            </div>
    
            <div class="col-md-4">
                <mat-label>ÙˆØ¶Ø¹ÛŒØª</mat-label>
                :
                <label>{{requests?.request?.statusTitle}}</label>
            </div>
            <div class="col-md-4">
                <mat-label>Ù¾ÛŒÚ© Ø§Ù†Ø¨Ø§Ø±</mat-label>
                :
                <label>{{requests?.request?.warehouseCourierTitle}}</label>
            </div>
            <div class="col-md-4">
                <mat-label>ÙÙˆØ±ÛŒ</mat-label>
                :
                <label *ngIf="requests?.request.force">Ø¨Ù„Ù‡</label>
                <label *ngIf="!requests?.request.force">Ø®ÛŒØ±</label>
            </div>

        </div>
    </mat-card>

    <div class="p-1">
        
            <mat-card *ngFor="let item of requests?.items">

                <div class="row">
                    <div class="col-md-8">
                        <div class="row">

                            <div class="col-md-3">
                                <label class="font-12">
                                    {{item.commodityName}}
                                </label>
                            </div>
                            <div class="col-md-2">
                                <label class="title">
                                    {{item.commodityCode}}
                                </label>

                            </div>

                            <div class="col-md-7">


                                <label>
                                    {{item.quantity| number : '1.0-2'}}

                                </label>
                                <span class="label">  {{item.measureTitle}} Ø§Ø² </span>


                                <label>
                                    {{item.inventory| number : '1.0-2'}}
                                </label>
                                <span class="label"> {{item.measureTitle}} Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ù†Ø¨Ø§Ø±</span>

                                <span class="label"> Ùˆ </span>
                                <label class="text-danger">
                                    {{item.quantityExit| number : '1.0-2'}}

                                </label>
                                <span class="label "> {{item.measureTitle}} Ø§Ø² Ú©Ù„ÛŒÙ‡ Ø§Ù†Ø¨Ø§Ø±Ù‡Ø§ Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù‡ Ø§Ø³Øª</span>

                                <!-- <span class="label" style="padding-right:10px;">ğŸ”…ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„  Ø®Ø±ÙˆØ¬ÛŒ Ø§Ø² Ù‡Ù…Ù‡ Ø§Ù†Ø¨Ø§Ø±Ù‡Ø§ </span>
                <label class="text-danger">
                    {{item.quantityExit | number : '1.0-2'}}

                </label> -->
                            </div>

                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="row" style="width: 100%">
                            <div class="col-md-5">
                                <mat-label>ØªØ­ÙˆÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡</mat-label>
                                :
                                <label class="label">{{item.placeUse}}-{{item.placeUseDetail}}</label>
                            </div>



                            <div class="col-md-4" *ngIf="item.layouts.length==0">
                                <button mat-raised-button color="primary" type="submit" (click)="AddInventory(item)">


                                    <span>Ø§ÙØ²ÙˆØ¯Ù† Ù…ÙˆÙ‚Ø¹ÛŒØª Ú©Ø§Ù„Ø§ Ø¯Ø± Ø§Ù†Ø¨Ø§Ø±</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            <div class="row">
                            <table class="mas-table">
                                <thead>
                                    <tr>
                                        <th resizable>Ú©Ø¯ Ú©Ø§Ù„Ø§</th>
                                        <th resizable>Ø§Ù†Ø¨Ø§Ø±</th>
                                        <th resizable>
                                            Ù…ÙˆÙ‚Ø¹ÛŒØª
                                        </th>
                                        <th resizable>
                                            Ù…ÙˆØ¬ÙˆØ¯ÛŒ
                                        </th>

                                        <th resizable>
                                            Ø§Ø¬Ø§Ø²Ù‡ Ø®Ø±ÙˆØ¬ Ø¯Ø§Ø±Ø¯ØŸ
                                        </th>
                                        <th resizable style="width:150px;">
                                            ØªØ¹Ø¯Ø§Ø¯ ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ù†Ø´Ø¯Ù‡
                                        </th>
                                        <th resizable>Ø´Ø±Ø­</th>
                                        <th resizable>
                                            ØªØ¹Ø¯Ø§Ø¯ ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ù…Ø­Ù„ Ø¯Ø± Ø§Ù†Ø¨Ø§Ø±
                                        </th>
                                        <th resizable>
                                            ÙˆØ§Ø­Ø¯ Ú©Ø§Ù„Ø§
                                        </th>
                                        <!--<th style="width:100px;">
                      Ø®Ø±ÙˆØ¬ Ú©Ø§Ù„Ø§
                    </th>-->
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let loyout of item?.layouts">
                                        <td>
                                            <span matTooltip="Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø§Ø±Ø¯Ú©Ø³ Ú©Ø§Ù„Ø§" class="btn-link" (click)="navigateToHistory(loyout.commodityId)">
                                                {{loyout.commodityCode}}
                                            </span>


                                        </td>
                                        <td>
                                            {{loyout.warehouseTitle}}
                                        </td>
                                        <td>
                                            {{loyout.warehouseLayoutTitle}}
                                        </td>
                                        <td>
                                            {{loyout.quantity | number : '1.0-0'}}
                                        </td>

                                        <td>
                                            <label *ngIf="loyout.allowOutput">Ø¨Ù„Ù‡</label>
                                            <label *ngIf="!loyout.allowOutput">Ø®ÛŒØ±</label>
                                        </td>
                                        <!--Ø§Ø¬Ø§Ø²Ù‡ Ø¬Ø±ÙˆØ¬ Ø¯Ø§Ø±Ø¯-->
                                        <td *ngIf="loyout.allowOutput">

                                            <span *ngIf="loyout.quantity<item.quantity" class="text-danger">
                                                Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ Ø§Ø² Ø§Ù†Ø¨Ø§Ø± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯
                                            </span>

                                            <span *ngIf="item.quantityExit==item.quantity">
                                                0
                                            </span>
                                            <input [(ngModel)]="loyout.totalQuantity"
                                                   *ngIf="item.quantityExit<item.quantity"
                                                   type="text"
                                                   required
                                                   class="form-control"
                                                   mask="separator.9" thousandSeparator=","
                                                   [disabled]="!loyout.disabled ? 'disabled': null">
                                        </td>
                                        <td *ngIf="!loyout.allowOutput" class="text-danger">
                                            Ø§Ø¬Ø§Ø²Ù‡ Ø®Ø±ÙˆØ¬ Ù†Ø¯Ø§Ø±Ø¯
                                        </td>
                                        <td>
                                            <input [(ngModel)]="item.description" *ngIf="item.quantityExit<item.quantity"
                                                   type="text"
                                                   class="form-control"
                                                   placeholder="Ø´Ø±Ø­">

                                            <span *ngIf="item.quantityExit==item.quantity">
                                                {{item.description}}
                                            </span>

                                        </td>
                                        <td>
                                            {{loyout.quantityOutput | number : '1.0-0'}}
                                        </td>
                                        <td>
                                            {{item.measureTitle}}
                                        </td>

                                    </tr>
                                </tbody>
                            </table>
                        </div>

</mat-card>

      

    </div>
    <mat-spinner style="top:30%;right:40%;position:absolute;z-index:1000" *ngIf="_notificationService.isLoader"></mat-spinner>

</div>
